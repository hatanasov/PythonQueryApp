# python-query-app

![Version: 0.1.0](https://img.shields.io/badge/Version-0.1.0-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 0.1.0](https://img.shields.io/badge/AppVersion-0.1.0-informational?style=flat-square)

This is a Python application that monitors external URLs, checks their availabilities, measures response times, and exposes metrics in **Prometheus format**. The application is containerized with Docker and can be deployed on a Kubernetes cluster using Helm.

- GitHub: https://github.com/hatanasov/PythonQueryApp
- Helm repository: https://hatanasov.github.io/PythonQueryApp/
- Dockerhub image:  https://hub.docker.com/r/hristoatanasov87/url_check_app_arm64

---

## Features

- Periodically checks a list of URLs for HTTP status `200`.  
- Measures response time in milliseconds.  
- Exposes Prometheus-compatible metrics at `/metrics` endpoint.  
- Fully configurable via environment variables.  
- Docker-ready for easy deployment on Kubernetes or other container platforms.

---

## Prerequisites

- Python 3.13+  
- Docker 20+ (for local containerization)  
- Kubernetes cluster (optional, for deployment)  
- Helm 3+ (optional, for deployment)  

---

## Environment Variables

| Variable | Default                                           | Description |
|----------|---------------------------------------------------|-------------|
| `URLS`  | `https://httpstat.us/200,https://httpstat.us/503` | Comma-separated list of URLs to monitor |
| `PORT`  | `9100`                                            | Port where the HTTP server exposes metrics |

---

## Running Locally

### 1. Clone the repository

```bash
git clone git@github.com:hatanasov/PythonQueryApp.git
cd PythonQueryApp
```

### 2. Create and activate virtual environment
```bash
python3 -m venv venv
source venv/bin/activate   # Linux/macOS
.\venv\Scripts\Activate.ps1  # Windows PowerShell
```

### 3. Install dependencies

```bash
pip install -r requirements.txt
```
### 4. Run the application

```bash
export URLS="https://httpstat.us/200,https://httpstat.us/503"
python QueryApp/main.py
```

### 5. Get prometheus metrics

```commandline
curl http://localhost:9100/metrics
```

## Install Chart

```bash
helm install [RELEASE_NAME] https://hatanasov.github.io/PythonQueryApp/python-query-app-0.1.0.tgz
```

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| affinity | object | `{}` |  |
| env[0].name | string | `"URLS"` |  |
| env[0].value | string | `"https://google.com,https://google.com/400"` |  |
| fullnameOverride | string | `""` |  |
| image.pullPolicy | string | `"IfNotPresent"` |  |
| image.repository | string | `"hristoatanasov87/url_check_app_arm64"` |  |
| image.tag | string | `"0.1.0"` |  |
| ingress.annotations | object | `{}` |  |
| ingress.className | string | `""` |  |
| ingress.enabled | bool | `false` |  |
| ingress.hosts[0].host | string | `"chart-example.local"` |  |
| ingress.hosts[0].paths[0].path | string | `"/"` |  |
| ingress.hosts[0].paths[0].pathType | string | `"ImplementationSpecific"` |  |
| ingress.tls | list | `[]` |  |
| nameOverride | string | `""` |  |
| nodeSelector | object | `{}` |  |
| podAnnotations | object | `{}` |  |
| podLabels | object | `{}` |  |
| podSecurityContext | object | `{}` |  |
| replicaCount | int | `1` |  |
| resources | object | `{}` |  |
| securityContext | object | `{}` |  |
| service.port | int | `9100` |  |
| service.targetPort | int | `9100` |  |
| service.type | string | `"ClusterIP"` |  |
| tolerations | list | `[]` |  |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.14.2](https://github.com/norwoodj/helm-docs/releases/v1.14.2)
